@reference "./global.css";

code[data-theme*=" "],
code[data-theme*=" "] span {
  /* Note: We don't apply the background color CSS var here as we are using our own custom color palette */
  /* https://rehype-pretty.pages.dev/#multiple-themes-dark-and-light-mode */
  @apply !bg-transparent;
  color: var(--shiki-light);
  /* background-color: var(--shiki-light-bg); */
}

figcaption + pre {
  @apply !rounded-t-none border border-gray-100/25;
}

.prose pre,
[data-rehype-pretty-code-figure] pre {
  @apply !bg-gray-100/25;
  @apply border border-gray-100;
}

[data-rehype-pretty-code-title] {
  @apply inline-flex items-center w-full rounded-t-md p-3 font-medium text-sm tracking-wide border border-b-0;
  @apply bg-gray-100/25 text-gray-400 border-gray-100;
}

.prose h1 > a,
.prose h2 > a,
.prose h3 > a,
.prose h4 > a,
.prose h5 > a,
.prose h6 > a {
  @apply float-left -ml-5 border-none opacity-0 hover:opacity-100 no-underline rounded-md;

  @apply transition duration-300 ease-in-out;

  @apply !text-gray-900;

  .icon-link:before {
    content: "#";
  }
}

.prose a {
  /* default-transition */
  @apply transition duration-300 ease-in-out;
  /* default-focus */
  @apply focus:outline-none focus:ring focus:ring-primary-500 dark:focus:ring-primary-600 focus:ring-offset-2 dark:focus:ring-offset-gray-900;
}

@media (prefers-color-scheme: dark) {
  code[data-theme*=" "],
  code[data-theme*=" "] span {
    color: var(--shiki-dark);
    /* background-color: var(--shiki-dark-bg); */
  }

  .prose pre,
  [data-rehype-pretty-code-figure] pre {
    @apply !bg-gray-900 border-gray-800;
  }

  [data-rehype-pretty-code-title] {
    @apply bg-gray-900 text-gray-400 border-gray-800;
  }

  .prose h1 > a,
  .prose h2 > a,
  .prose h3 > a,
  .prose h4 > a,
  .prose h5 > a,
  .prose h6 > a {
    @apply !text-white;
  }

  figcaption[data-language="astro"] {
    &::before {
      content: url("/lang/astro-dark.svg") !important;
    }
  }

  figcaption[data-language="rs"],
  figcaption[data-language="rust"] {
    &::before {
      @apply invert;
    }
  }
}

/** ------------------------------------------------------------------------------ */

/* GitHub-style callouts (admonitions) */
.prose blockquote.callout,
.prose .callout {
  @apply not-italic my-6 rounded-md border p-4;
  @apply bg-gray-100/25 text-gray-600 border-gray-100;
}

@media (prefers-color-scheme: dark) {
  .prose blockquote.callout,
  .prose .callout {
    @apply bg-gray-900/40 text-gray-300 border-gray-800;
  }
}

/* Improve paragraph wrapping to avoid large word gaps */
.prose p {
  hyphens: auto;
  overflow-wrap: anywhere;
  text-wrap-style: pretty;
}

/* Title */
.prose blockquote.callout > h5,
.prose .callout > h5 {
  @apply m-0 mb-2 flex items-center gap-2 text-sm font-semibold leading-5;
  @apply text-gray-800;
}

@media (prefers-color-scheme: dark) {
  .prose blockquote.callout > h5,
  .prose .callout > h5 {
    @apply text-gray-100;
  }
}

/* Body */
.prose blockquote.callout > div :where(p, ul, ol):first-child,
.prose .callout > div :where(p, ul, ol):first-child {
  @apply mt-0;
}

.prose blockquote.callout > div :where(p, ul, ol):last-child,
.prose .callout > div :where(p, ul, ol):last-child {
  @apply mb-0;
}

/* Remove typographic quote marks that Tailwind Typography adds to blockquotes */
.prose blockquote.callout :where(p):first-child::before,
.prose .callout :where(p):first-child::before,
.prose blockquote.callout :where(p):last-child::after,
.prose .callout :where(p):last-child::after {
  content: none;
}

/* Variants: left-accent and heading color + icon */
/* NOTE */
.prose blockquote.callout.note,
.prose .callout.note {
  @apply border-l-4;
  border-left-color: var(--color-primary-400);
}
.prose blockquote.callout.note > h5,
.prose .callout.note > h5 {
  @apply text-primary-600;
}
.prose blockquote.callout.note > h5::before,
.prose .callout.note > h5::before {
  content: none;
}

/* TIP */
.prose blockquote.callout.tip,
.prose .callout.tip {
  @apply border-l-4 border-green-400;
}
.prose blockquote.callout.tip > h5,
.prose .callout.tip > h5 {
  @apply text-green-600;
}
.prose blockquote.callout.tip > h5::before,
.prose .callout.tip > h5::before {
  content: none;
}

/* IMPORTANT */
.prose blockquote.callout.important,
.prose .callout.important {
  @apply border-l-4 border-purple-400;
}
.prose blockquote.callout.important > h5,
.prose .callout.important > h5 {
  @apply text-purple-600;
}
.prose blockquote.callout.important > h5::before,
.prose .callout.important > h5::before {
  content: none;
}

/* WARNING */
.prose blockquote.callout.warning,
.prose .callout.warning {
  @apply border-l-4 border-amber-400;
}
.prose blockquote.callout.warning > h5,
.prose .callout.warning > h5 {
  @apply text-amber-600;
}
.prose blockquote.callout.warning > h5::before,
.prose .callout.warning > h5::before {
  content: none;
}

/* CAUTION */
.prose blockquote.callout.caution,
.prose .callout.caution {
  @apply border-l-4 border-red-400;
}
.prose blockquote.callout.caution > h5,
.prose .callout.caution > h5 {
  @apply text-red-600;
}
.prose blockquote.callout.caution > h5::before,
.prose .callout.caution > h5::before {
  content: none;
}

figcaption[data-language="js"],
figcaption[data-language="javascript"] {
  &::before {
    @apply mr-2 w-4 h-4;
    content: url("/lang/javascript.svg");
  }
}

figcaption[data-language="ts"],
figcaption[data-language="typescript"] {
  &::before {
    @apply mr-2 w-4 h-4;
    content: url("/lang/typescript.svg");
  }
}

figcaption[data-language="jsx"],
figcaption[data-language="tsx"] {
  &::before {
    @apply mr-2 w-4 h-4;
    content: url("/lang/react.svg");
  }
}

figcaption[data-language="rs"],
figcaption[data-language="rust"] {
  &::before {
    @apply mr-2 w-4 h-4;
    content: url("/lang/rust.svg");
  }
}

figcaption[data-language="astro"] {
  &::before {
    @apply mr-2 w-4 h-4;
    content: url("/lang/astro-light.svg");
  }
}
