@reference "./global.css";

/* ============================================================================
   PROSE TYPOGRAPHY
   Clean, readable article styling inspired by modern developer blogs
   ============================================================================ */

/* Base prose improvements */
.prose {
  font-size: 1.125rem;
  line-height: 1.8;
  color: theme(colors.stone.700);
}

@media (prefers-color-scheme: dark) {
  .prose {
    color: theme(colors.stone.300);
  }
}

/* Paragraph spacing and wrapping */
.prose p {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
  hyphens: auto;
  overflow-wrap: anywhere;
  text-wrap: pretty;
}

/* Headings */
.prose h2 {
  font-size: 1.5rem;
  font-weight: 700;
  letter-spacing: -0.02em;
  margin-top: 2.5em;
  margin-bottom: 1em;
  color: theme(colors.stone.900);
}

.prose h3 {
  font-size: 1.25rem;
  font-weight: 600;
  letter-spacing: -0.01em;
  margin-top: 2em;
  margin-bottom: 0.75em;
  color: theme(colors.stone.900);
}

.prose h4 {
  font-size: 1.125rem;
  font-weight: 600;
  margin-top: 1.75em;
  margin-bottom: 0.5em;
  color: theme(colors.stone.900);
}

@media (prefers-color-scheme: dark) {
  .prose h2,
  .prose h3,
  .prose h4 {
    color: theme(colors.white);
  }
}

/* Links */
.prose a {
  color: theme(colors.blue.600);
  text-decoration: underline;
  text-underline-offset: 3px;
  text-decoration-thickness: 1px;
  text-decoration-color: theme(colors.blue.300);
  @apply transition duration-300 ease-in-out;
  @apply focus:outline-none focus:ring focus:ring-primary-500 dark:focus:ring-primary-600 focus:ring-offset-2 dark:focus:ring-offset-stone-900;
}

.prose a:hover {
  text-decoration-color: theme(colors.blue.600);
  text-decoration-thickness: 2px;
}

@media (prefers-color-scheme: dark) {
  .prose a {
    color: theme(colors.blue.400);
    text-decoration-color: theme(colors.blue.700);
  }

  .prose a:hover {
    text-decoration-color: theme(colors.blue.400);
  }
}

/* Heading anchor links */
.prose h1 > a,
.prose h2 > a,
.prose h3 > a,
.prose h4 > a,
.prose h5 > a,
.prose h6 > a {
  @apply float-left -ml-5 border-none opacity-0 hover:opacity-100 no-underline rounded-md;
  @apply transition duration-300 ease-in-out;
  color: theme(colors.stone.400);

  .icon-link:before {
    content: "#";
  }
}

@media (prefers-color-scheme: dark) {
  .prose h1 > a,
  .prose h2 > a,
  .prose h3 > a,
  .prose h4 > a,
  .prose h5 > a,
  .prose h6 > a {
    color: theme(colors.stone.500);
  }
}

/* Lists */
.prose ul,
.prose ol {
  margin-top: 1.25em;
  margin-bottom: 1.25em;
  padding-left: 1.5em;
}

.prose li {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

.prose li::marker {
  color: theme(colors.stone.400);
}

@media (prefers-color-scheme: dark) {
  .prose li::marker {
    color: theme(colors.stone.500);
  }
}

/* Strong text */
.prose strong {
  font-weight: 600;
  color: theme(colors.stone.900);
}

@media (prefers-color-scheme: dark) {
  .prose strong {
    color: theme(colors.white);
  }
}

/* Inline code */
.prose :where(code):not(:where(pre *)) {
  font-family: var(--font-mono);
  font-size: 0.875em;
  font-weight: 500;
  padding: 0.2em 0.4em;
  border-radius: 0.375rem;
  background-color: theme(colors.stone.200);
  color: theme(colors.stone.800);
}

@media (prefers-color-scheme: dark) {
  .prose :where(code):not(:where(pre *)) {
    background-color: theme(colors.stone.800);
    color: theme(colors.stone.200);
  }
}

/* Blockquotes */
.prose blockquote:not(.callout) {
  font-style: normal;
  border-left-width: 3px;
  border-left-color: theme(colors.stone.300);
  padding-left: 1.25em;
  margin-top: 1.5em;
  margin-bottom: 1.5em;
  color: theme(colors.stone.600);
}

@media (prefers-color-scheme: dark) {
  .prose blockquote:not(.callout) {
    border-left-color: theme(colors.stone.700);
    color: theme(colors.stone.400);
  }
}

.prose blockquote p:first-of-type::before,
.prose blockquote p:last-of-type::after {
  content: none;
}

/* Horizontal rules */
.prose hr {
  margin-top: 3em;
  margin-bottom: 3em;
  border: none;
  border-top: 1px solid theme(colors.stone.200);
}

@media (prefers-color-scheme: dark) {
  .prose hr {
    border-top-color: theme(colors.stone.800);
  }
}

/* Images */
.prose img {
  border-radius: 0.5rem;
  margin-top: 2em;
  margin-bottom: 2em;
}

/* Tables */
.prose table {
  font-size: 0.875em;
  margin-top: 2em;
  margin-bottom: 2em;
  width: 100%;
}

.prose th {
  font-weight: 600;
  text-align: left;
  padding: 0.75em 1em;
  border-bottom: 2px solid theme(colors.stone.200);
  color: theme(colors.stone.900);
}

.prose td {
  padding: 0.75em 1em;
  border-bottom: 1px solid theme(colors.stone.100);
  color: theme(colors.stone.600);
}

@media (prefers-color-scheme: dark) {
  .prose th {
    border-bottom-color: theme(colors.stone.700);
    color: theme(colors.white);
  }

  .prose td {
    border-bottom-color: theme(colors.stone.800);
    color: theme(colors.stone.300);
  }
}

/* ============================================================================
   CODE BLOCKS
   ============================================================================ */

code[data-theme*=" "],
code[data-theme*=" "] span {
  @apply !bg-transparent;
  color: var(--shiki-light);
}

@media (prefers-color-scheme: dark) {
  code[data-theme*=" "],
  code[data-theme*=" "] span {
    color: var(--shiki-dark);
  }
}

.prose pre,
[data-rehype-pretty-code-figure] pre {
  font-size: 0.875rem;
  line-height: 1.7;
  padding: 1.25rem 1.5rem;
  border-radius: 0.5rem;
  overflow-x: auto;
  @apply !bg-stone-100 border border-stone-200;
}

@media (prefers-color-scheme: dark) {
  .prose pre,
  [data-rehype-pretty-code-figure] pre {
    @apply !bg-stone-900 border-stone-800;
  }
}

figcaption + pre {
  @apply !rounded-t-none;
}

[data-rehype-pretty-code-title] {
  @apply inline-flex items-center w-full rounded-t-lg px-4 py-3 font-medium text-sm border border-b-0;
  @apply bg-stone-200 text-stone-600 border-stone-200;
  font-family: var(--font-mono);
}

@media (prefers-color-scheme: dark) {
  [data-rehype-pretty-code-title] {
    @apply bg-stone-800 text-stone-400 border-stone-800;
  }
}

/* Language icons */
figcaption[data-language="js"]::before,
figcaption[data-language="javascript"]::before {
  @apply mr-2 w-4 h-4;
  content: url("/lang/javascript.svg");
}

figcaption[data-language="ts"]::before,
figcaption[data-language="typescript"]::before {
  @apply mr-2 w-4 h-4;
  content: url("/lang/typescript.svg");
}

figcaption[data-language="jsx"]::before,
figcaption[data-language="tsx"]::before {
  @apply mr-2 w-4 h-4;
  content: url("/lang/react.svg");
}

figcaption[data-language="rs"]::before,
figcaption[data-language="rust"]::before {
  @apply mr-2 w-4 h-4;
  content: url("/lang/rust.svg");
}

figcaption[data-language="astro"]::before {
  @apply mr-2 w-4 h-4;
  content: url("/lang/astro-light.svg");
}

@media (prefers-color-scheme: dark) {
  figcaption[data-language="astro"]::before {
    content: url("/lang/astro-dark.svg") !important;
  }

  figcaption[data-language="rs"]::before,
  figcaption[data-language="rust"]::before {
    @apply invert;
  }
}

/* ============================================================================
   CALLOUTS
   ============================================================================ */

.prose blockquote.callout,
.prose .callout {
  @apply not-italic my-6 rounded-lg border-l-4 p-4;
  @apply bg-stone-100 text-stone-700 border-stone-300;
}

@media (prefers-color-scheme: dark) {
  .prose blockquote.callout,
  .prose .callout {
    @apply bg-stone-900/50 text-stone-300 border-stone-600;
  }
}

.prose blockquote.callout > h5,
.prose .callout > h5 {
  @apply m-0 mb-2 flex items-center gap-2 text-sm font-semibold leading-5;
  @apply text-stone-900;
}

@media (prefers-color-scheme: dark) {
  .prose blockquote.callout > h5,
  .prose .callout > h5 {
    @apply text-stone-100;
  }
}

.prose blockquote.callout > div :where(p, ul, ol):first-child,
.prose .callout > div :where(p, ul, ol):first-child {
  @apply mt-0;
}

.prose blockquote.callout > div :where(p, ul, ol):last-child,
.prose .callout > div :where(p, ul, ol):last-child {
  @apply mb-0;
}

.prose blockquote.callout :where(p):first-child::before,
.prose .callout :where(p):first-child::before,
.prose blockquote.callout :where(p):last-child::after,
.prose .callout :where(p):last-child::after {
  content: none;
}

/* Callout variants */
.prose blockquote.callout.note,
.prose .callout.note {
  border-left-color: var(--color-primary-400);
}
.prose blockquote.callout.note > h5,
.prose .callout.note > h5 {
  @apply text-primary-600;
}

.prose blockquote.callout.tip,
.prose .callout.tip {
  @apply border-green-400;
}
.prose blockquote.callout.tip > h5,
.prose .callout.tip > h5 {
  @apply text-green-600;
}

.prose blockquote.callout.important,
.prose .callout.important {
  @apply border-purple-400;
}
.prose blockquote.callout.important > h5,
.prose .callout.important > h5 {
  @apply text-purple-600;
}

.prose blockquote.callout.warning,
.prose .callout.warning {
  @apply border-amber-400;
}
.prose blockquote.callout.warning > h5,
.prose .callout.warning > h5 {
  @apply text-amber-600;
}

.prose blockquote.callout.caution,
.prose .callout.caution {
  @apply border-red-400;
}
.prose blockquote.callout.caution > h5,
.prose .callout.caution > h5 {
  @apply text-red-600;
}
