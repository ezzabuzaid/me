---
export interface Heading {
	depth: number;
	slug: string;
	text: string;
}

export interface Props {
	headings: Heading[];
}

const { headings } = Astro.props;

// Only show h2 and h3 headings, and only if there are 3+ headings
const filteredHeadings = headings.filter((h) => h.depth >= 2 && h.depth <= 3);
const shouldShow = filteredHeadings.length >= 3;
---

{shouldShow && (
	<nav class="space-y-4 p-4 border border-gray-800 bg-gray-900" aria-label="Table of contents">
		<h2 class="flex items-center font-mono text-xs uppercase tracking-[0.15em] text-gray-400">
			<span class="text-primary-500 mr-2">â—‡</span>
			Contents
		</h2>
		<ul class="space-y-2 font-mono text-sm">
			{filteredHeadings.map((heading, index) => (
				<li
					class={heading.depth === 3 ? 'ml-4' : ''}
				>
					<a
						href={`#${heading.slug}`}
						class="group flex items-center text-gray-500 hover:text-primary-500 default-transition"
					>
						<span class="text-gray-700 mr-2 text-xs">{String(index + 1).padStart(2, '0')}</span>
						<span class="group-hover:underline underline-offset-2">{heading.text}</span>
					</a>
				</li>
			))}
		</ul>
	</nav>
)}
